@startuml
!include style.puml
skinparam arrowThickness 1.1
skinparam arrowColor MODEL_COLOR
skinparam classBackgroundColor MODEL_COLOR

' === INVISIBLE HELPER OUTSIDE THE PACKAGE ===
Class I #FFFFFF

Package Model as ModelPackage <<Rectangle>> {
  ' === TOP ROW: INTERFACES ===
  Class "<<interface>>\nReadOnlyAddressBook" as ReadOnlyAddressBook
  Class "<<interface>>\nModel" as Model
  Class "<<interface>>\nReadOnlyUserPrefs" as ReadOnlyUserPrefs

  ' === SECOND ROW: IMPLEMENTATIONS ===
  Class AddressBook
  Class ModelManager
  Class UserPrefs

  ' === THIRD ROW: UNIQUE LISTS ===
  Class UniquePersonList
  Class UniqueEventList
  Class UniqueTodoList

  ' === FOURTH ROW: ENTITIES ===
  Class Person
  Class Event
  Class Todo

  ' === PERSON FIELD CLASSES ===
  Class Name
  Class Phone
  Class Email
  Class Address
  Class Tag

  ' === EVENT FIELD CLASSES ===
  Class EventName
  Class EventAlias

  ' === TODO FIELD CLASSES ===
  Class TodoName
}

' === DASHED REFERENCE FROM OUTSIDE ===
I ..> Model

' === LAYOUT: TOP ROW - FORCE EQUAL SPACING ===
ReadOnlyAddressBook -[hidden]right-> Model
Model -[hidden]right-> ReadOnlyUserPrefs

' === LAYOUT: ALIGN IMPLEMENTATIONS UNDER INTERFACES ===
ReadOnlyAddressBook -[hidden]down-> AddressBook
Model -[hidden]down-> ModelManager
ReadOnlyUserPrefs -[hidden]down-> UserPrefs

' === LAYOUT: SECOND ROW ===
AddressBook -[hidden]right-> ModelManager
ModelManager -[hidden]right-> UserPrefs

' === LAYOUT: ALIGN UNIQUE LISTS ===
AddressBook -[hidden]down-> UniquePersonList
UniquePersonList -[hidden]right-> UniqueEventList
UniqueEventList -[hidden]right-> UniqueTodoList

' === LAYOUT: ALIGN ENTITIES ===
UniquePersonList -[hidden]down-> Person
UniqueEventList -[hidden]down-> Event
UniqueTodoList -[hidden]down-> Todo
Person -[hidden]right-> Event
Event -[hidden]right-> Todo

' === CORE INTERFACE RELATIONSHIPS ===
AddressBook .up.|> ReadOnlyAddressBook
UserPrefs .up.|> ReadOnlyUserPrefs
ModelManager .up.|> Model
Model ..> ReadOnlyAddressBook
Model ..> ReadOnlyUserPrefs

' === MODELMANAGER RELATIONSHIPS ===
ModelManager --> "1" AddressBook
ModelManager --> "1" UserPrefs

' === ADDRESSBOOK TO UNIQUE LISTS ===
AddressBook *--> "1" UniquePersonList
AddressBook *--> "1" UniqueEventList
AddressBook *--> "1" UniqueTodoList

' === UNIQUE LISTS TO ENTITIES ===
UniquePersonList --> "* all" Person
UniqueEventList --> "* all" Event
UniqueTodoList --> "* all" Todo

' === MODELMANAGER FILTERED LISTS ===
ModelManager --> "* filtered" Person
ModelManager --> "* filtered" Event
ModelManager --> "* filtered" Todo

' === PERSON FIELD RELATIONSHIPS ===
Person *--> Name
Person *--> Phone
Person *--> Email
Person *--> Address
Person *--> "*" Tag
Person *--> "0..1" EventAlias

' === EVENT FIELD RELATIONSHIPS ===
Event *--> EventName
Event *--> EventAlias

' === TODO FIELD RELATIONSHIPS ===
Todo *--> TodoName
Todo *--> "0..1" Name

@enduml